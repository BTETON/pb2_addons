<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="customer_dunning_report" language="groovy" pageWidth="595" pageHeight="842" columnWidth="515" leftMargin="40" rightMargin="40" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.2100000000000037"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="border_box">
		<box topPadding="2" leftPadding="2" bottomPadding="2" rightPadding="2">
			<topPen lineWidth="0.5" lineStyle="Solid"/>
			<leftPen lineWidth="0.5" lineStyle="Solid"/>
			<bottomPen lineWidth="0.5" lineStyle="Solid"/>
			<rightPen lineWidth="0.5"/>
		</box>
	</style>
	<style name="space" lineSpacing="Double" markup="styled" pattern=""/>
	<parameter name="COPY" class="java.lang.Integer" isForPrompting="false"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA[System.getProperty("user.dir")
+"/../../../pb2_pabi/pabi_hr_expense_report/pabi_dunning_letter/report/"]]></defaultValueExpression>
	</parameter>
	<parameter name="date_run" class="java.lang.String" isForPrompting="false"/>
	<parameter name="signature_dunning_en" class="java.lang.String" isForPrompting="false"/>
	<parameter name="signature_litigation_en" class="java.lang.String" isForPrompting="false"/>
	<parameter name="account_dept_contact_en" class="java.lang.String" isForPrompting="false"/>
	<queryString language="xPath">
		<![CDATA[/data/record]]>
	</queryString>
	<field name="street" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/street]]></fieldDescription>
	</field>
	<field name="street2" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/street2]]></fieldDescription>
	</field>
	<field name="city" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/city]]></fieldDescription>
	</field>
	<field name="state" class="java.lang.String">
		<fieldDescription><![CDATA[state]]></fieldDescription>
	</field>
	<field name="country" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/country_id/name]]></fieldDescription>
	</field>
	<field name="zip" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/zip]]></fieldDescription>
	</field>
	<field name="district" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/district_id/name]]></fieldDescription>
	</field>
	<field name="township" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/township_id/name]]></fieldDescription>
	</field>
	<field name="province" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/province_id/name]]></fieldDescription>
	</field>
	<field name="new_title" class="java.lang.String">
		<fieldDescription><![CDATA[new_title]]></fieldDescription>
	</field>
	<field name="title" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/title/name]]></fieldDescription>
	</field>
	<field name="partner_name" class="java.lang.String">
		<fieldDescription><![CDATA[partner_id/name]]></fieldDescription>
	</field>
	<field name="partner_id" class="java.lang.Number">
		<fieldDescription><![CDATA[partner_id/id]]></fieldDescription>
	</field>
	<field name="invoice_ref" class="java.lang.String">
		<fieldDescription><![CDATA[move_line_id/ref]]></fieldDescription>
	</field>
	<field name="date" class="java.util.Date">
		<fieldDescription><![CDATA[move_line_id/date]]></fieldDescription>
	</field>
	<field name="line_item_summary" class="java.lang.String">
		<fieldDescription><![CDATA[move_line_id/move_id/line_item_summary]]></fieldDescription>
	</field>
	<field name="amount" class="java.lang.Number">
		<fieldDescription><![CDATA[move_line_id/amount_residual]]></fieldDescription>
	</field>
	<field name="due_date" class="java.util.Date">
		<fieldDescription><![CDATA[move_line_id/date_maturity]]></fieldDescription>
	</field>
	<variable name="amount_total" class="java.lang.Number" resetType="Group" resetGroup="UniquePartner" calculation="Sum">
		<variableExpression><![CDATA[$F{amount}]]></variableExpression>
	</variable>
	<variable name="myPAGE_NUMBER" class="java.lang.Integer" resetType="Group" resetGroup="UniquePartner" calculation="Count">
		<variableExpression><![CDATA[$V{myPAGE_NUMBER}]]></variableExpression>
		<initialValueExpression><![CDATA[]]></initialValueExpression>
	</variable>
	<variable name="page_count" class="java.lang.Integer" incrementType="Page" calculation="Count">
		<variableExpression><![CDATA[$V{page_count}]]></variableExpression>
		<initialValueExpression><![CDATA[new Integer(0)]]></initialValueExpression>
	</variable>
	<group name="UniquePartner" isStartNewPage="true" isResetPageNumber="true">
		<groupExpression><![CDATA[$F{partner_id}]]></groupExpression>
		<groupHeader>
			<band height="223">
				<staticText>
					<reportElement style="space" x="30" y="141" width="207" height="16"/>
					<textElement lineSpacing="Single" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Regarding a payment of ]]></text>
				</staticText>
				<staticText>
					<reportElement style="border_box" x="0" y="203" width="116" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font size="11" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Invoice]]></text>
				</staticText>
				<staticText>
					<reportElement style="border_box" x="116" y="203" width="140" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font size="11" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Date]]></text>
				</staticText>
				<staticText>
					<reportElement style="border_box" x="256" y="203" width="135" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font size="11" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Due Date]]></text>
				</staticText>
				<staticText>
					<reportElement style="border_box" x="391" y="203" width="124" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" lineSpacing="Single">
						<font size="11" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Amount]]></text>
				</staticText>
				<textField>
					<reportElement x="0" y="56" width="555" height="14"/>
					<textElement lineSpacing="Single" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Subject : " + "Reminder notice #1"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="1" y="-1" width="555" height="14"/>
					<textElement lineSpacing="Single" markup="none">
						<font size="11" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["No. 54"]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement style="space" x="0" y="159" width="554" height="16"/>
					<textElement lineSpacing="Single" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Please give this matter your earliest attention and submit a remittance by return.]]></text>
				</staticText>
				<textField pattern="MMMMM dd, yyyy">
					<reportElement x="1" y="28" width="555" height="14"/>
					<textElement lineSpacing="Single" markup="none">
						<font size="11" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.util.Date"><![CDATA[$F{date}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement style="space" x="1" y="85" width="103" height="16"/>
					<textElement lineSpacing="Single" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Dear Sir,]]></text>
				</staticText>
				<textField>
					<reportElement x="1" y="116" width="555" height="14"/>
					<textElement lineSpacing="Single" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA["Reference : " + "???? from myProperty ?????"]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" evaluationTime="Group" evaluationGroup="UniquePartner" pattern="#,##0.00" isBlankWhenNull="false">
					<reportElement stretchType="RelativeToTallestObject" x="122" y="141" width="156" height="16"/>
					<textElement textAlignment="Center" lineSpacing="Single" markup="none">
						<font size="11" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{amount_total}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement style="space" x="0" y="187" width="554" height="16"/>
					<textElement lineSpacing="Single" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Reference:]]></text>
				</staticText>
				<staticText>
					<reportElement style="space" x="256" y="141" width="255" height="16"/>
					<textElement lineSpacing="Single" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Baht, which is now overdue.]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="291">
				<staticText>
					<reportElement x="0" y="47" width="515" height="76"/>
					<textElement lineSpacing="1_1_2" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[          The outstanding balance due for remittance lapsed on the above date, and we are apparently yet to receive payment. Please continue to make payments, completed within seven days from the date you receive this letter. We reserve the right to levy a fine for late payments, at the rate specified in the contract. ]]></text>
				</staticText>
				<staticText>
					<reportElement x="0" y="123" width="515" height="55"/>
					<textElement lineSpacing="1_1_2" markup="none">
						<font size="11" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[          If payment has been made, please disregard this reminder and accept our thanks for your kind submission of the amount referred to above.]]></text>
				</staticText>
				<staticText>
					<reportElement x="0" y="178" width="256" height="16"/>
					<textElement lineSpacing="Single" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Yours faithfully,]]></text>
				</staticText>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement x="1" y="225" width="336" height="66"/>
					<textElement lineSpacing="1_1_2" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$P{signature_dunning_en}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="217" y="7" width="120" height="16"/>
					<textElement textAlignment="Right" lineSpacing="Single" markup="none">
						<font size="12" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<text><![CDATA[Grand Total]]></text>
				</staticText>
				<line>
					<reportElement x="432" y="23" width="83" height="1"/>
				</line>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="false">
					<reportElement stretchType="RelativeToTallestObject" x="369" y="7" width="146" height="16"/>
					<textElement textAlignment="Right" lineSpacing="Single" markup="none">
						<font size="12" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.Number"><![CDATA[$V{amount_total}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" isBlankWhenNull="true">
					<reportElement x="256" y="225" width="259" height="66"/>
					<textElement textAlignment="Right" verticalAlignment="Top" lineSpacing="1_1_2" markup="none">
						<font size="11" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[$P{account_dept_contact_en}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<pageHeader>
		<band height="42" splitType="Stretch">
			<image>
				<reportElement x="390" y="0" width="124" height="42"/>
				<imageExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "logo_nstda.jpg"]]></imageExpression>
			</image>
		</band>
	</pageHeader>
	<detail>
		<band height="25" splitType="Stretch">
			<textField isStretchWithOverflow="true">
				<reportElement style="border_box" stretchType="RelativeToTallestObject" x="0" y="0" width="116" height="25"/>
				<textElement textAlignment="Center" lineSpacing="Single" markup="none">
					<font size="10" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{invoice_ref}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd MMMMM yyyy">
				<reportElement style="border_box" stretchType="RelativeToTallestObject" x="116" y="0" width="140" height="25"/>
				<textElement textAlignment="Center" lineSpacing="Single" markup="none">
					<font size="10" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{date}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd MMMMM yyyy">
				<reportElement style="border_box" stretchType="RelativeToTallestObject" x="256" y="0" width="135" height="25"/>
				<textElement textAlignment="Center" lineSpacing="Single" markup="none">
					<font size="10" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{due_date}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="false">
				<reportElement style="border_box" stretchType="RelativeToTallestObject" x="391" y="0" width="124" height="25"/>
				<textElement textAlignment="Right" lineSpacing="Single" markup="none">
					<font size="10" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{amount}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="22">
			<textField>
				<reportElement x="391" y="0" width="80" height="20" forecolor="#000000"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="12" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Page "+$V{PAGE_NUMBER}+" of"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Group" evaluationGroup="UniquePartner">
				<reportElement x="471" y="0" width="40" height="20" forecolor="#000000"/>
				<textElement verticalAlignment="Middle">
					<font size="12" isBold="false" pdfFontName="Garuda.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
