<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
        <!-- Directory -->
        <record model="document.directory" id="dir_special_project_template">
            <field name="name">Special Project</field>
            <field name="parent_id" ref="document.dir_root"/>
            <field name="user_id" ref="base.user_root"/>
            <field name="ressource_id">0</field>
        </record>

        <record id="special_project_template" model="ir.attachment">
            <field name="res_model">account.move</field>
            <field name="datas_fname">special_project.xls</field>
            <field name="name">Special Project</field>
            <field name="parent_id" eval="ref('dir_special_project_template')"/>
            <field name="description">
              {
                '__EXPORT__': {
                    # 1: {
                    #    'line_id': {
                    #        'A2': 'sequence',
                    #        'B2': 'move_id.date',
                    #        'D2': 'move_id.ref',
                    #        'E2': 'name',
                    #        'F2': 'account_id.code${env["pabi.data.map"].get_out_value("Special Project - A", "account.account", "code", value)}',
                    #        'H2': 'section_id.code',
                    #        'I2': 'debit',
                    #        'J2': 'credit',
                    #    }
                    # }
                },
                '__IMPORT__': {
                    1: {
                        '_HEAD_': {
                            'B2': 'date',
                            'D2': 'ref',
                        },
                        'line_id': {
                            'A2': 'sequence',
                            'E2': 'name',
                            # Following will be different for each Special Project
                            'F2': 'account_id${env["pabi.data.map"].get_in_value(context.get("map_type"), "account.account", "code", value)}',
                            'H2': 'section_id',
                            'I2': 'debit',
                            'J2': 'credit',
                        }
                    }
                },
            }
          </field>
        </record>
    </data>
</openerp>
