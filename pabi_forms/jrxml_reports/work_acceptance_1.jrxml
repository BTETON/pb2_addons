<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report3" language="groovy" pageWidth="595" pageHeight="842" columnWidth="431" leftMargin="79" rightMargin="85" topMargin="70" bottomMargin="107">
	<property name="ireport.zoom" value="2.143588810000003"/>
	<property name="ireport.x" value="582"/>
	<property name="ireport.y" value="645"/>
	<parameter name="IDS" class="java.lang.Object"/>
	<parameter name="PIDS" class="java.util.List" isForPrompting="false">
		<defaultValueExpression><![CDATA[$P{IDS}.toList()]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
po.id,
rp.name supplier,
rp_ou.name operating_unit,
po.name PO_NO,
po.date_contract_start contract_start_date,
po.amount_total_text_th,
po.amount_total amount,
pwa.date_receive date_receive,
po.fine_rate fine_rate,
po.doc_approve_uid,
hp.name hr_position,
ro.description,
date_part('day',(po.date_contract_start-po.date_order))::integer in_time,
rpa.name name_approve,
convert_from(rp_ou.image, 'UTF8') image ,
po.date_order date_order,
pwa.fine_per_day,
pwa.amount_fine_per_day_text_th,
pwa.overdue_day

from purchase_order po
left join res_partner rp on po.partner_id = rp.id
left join operating_unit ou on po.operating_unit_id = ou.id
left join res_partner rp_ou on ou.partner_id = rp_ou.id
left join res_country rc on rp_ou.country_id = rc.id
left join res_country_district rcd on rp_ou.district_id = rcd.id
left join purchase_work_acceptance pwa on po.id = pwa.order_id
LEFT JOIN res_users ru ON ru.id = po.doc_approve_uid
LEFT JOIN res_partner rpa ON rpa.id = ru.partner_id
LEFT JOIN hr_employee he ON he.employee_code = ru.login
LEFT JOIN hr_position hp ON hp.id = he.position_id
LEFT JOIN res_org ro ON ro.id = he.org_id

where $X{IN,pwa.id, PIDS} and po.name not like '-']]>
	</queryString>
	<field name="id" class="java.lang.Integer"/>
	<field name="supplier" class="java.lang.String">
		<fieldDescription><![CDATA[Supplier]]></fieldDescription>
	</field>
	<field name="operating_unit" class="java.lang.String"/>
	<field name="po_no" class="java.lang.String"/>
	<field name="contract_start_date" class="java.sql.Date"/>
	<field name="amount_total_text_th" class="java.lang.String">
		<fieldDescription><![CDATA[Amount Total (TH)]]></fieldDescription>
	</field>
	<field name="amount" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[Amount]]></fieldDescription>
	</field>
	<field name="date_receive" class="java.sql.Date">
		<fieldDescription><![CDATA[Receive Date]]></fieldDescription>
	</field>
	<field name="fine_rate" class="java.lang.Double">
		<fieldDescription><![CDATA[Fine Rate]]></fieldDescription>
	</field>
	<field name="doc_approve_uid" class="java.lang.Integer">
		<fieldDescription><![CDATA[Approved by]]></fieldDescription>
	</field>
	<field name="hr_position" class="java.lang.String"/>
	<field name="description" class="java.lang.String"/>
	<field name="in_time" class="java.lang.Integer"/>
	<field name="name_approve" class="java.lang.String"/>
	<field name="image" class="java.lang.String">
		<fieldDescription><![CDATA[Photo]]></fieldDescription>
	</field>
	<field name="date_order" class="java.sql.Timestamp">
		<fieldDescription><![CDATA[Order Date]]></fieldDescription>
	</field>
	<field name="fine_per_day" class="java.lang.Double">
		<fieldDescription><![CDATA[Fine per Day]]></fieldDescription>
	</field>
	<field name="amount_fine_per_day_text_th" class="java.lang.String">
		<fieldDescription><![CDATA[Fine per Day TH Text]]></fieldDescription>
	</field>
	<field name="overdue_day" class="java.lang.Integer">
		<fieldDescription><![CDATA[Overdue Days]]></fieldDescription>
	</field>
	<background>
		<band height="665" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement x="199" y="526" width="100" height="14"/>
				<textElement textAlignment="Center" lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="11" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{name_approve}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="220" y="463" width="68" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="11" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[ขอแสดงความนับถือ]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="199" y="540" width="100" height="14"/>
				<textElement textAlignment="Center" lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="11" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{hr_position}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="199" y="554" width="100" height="14"/>
				<textElement textAlignment="Center" lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="11" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{description}]]></textFieldExpression>
			</textField>
		</band>
	</background>
	<pageHeader>
		<band height="81" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="116" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="26" height="20"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[ที่ วท]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="40" width="178" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[เรื่อง          ติดตามงานส่งมอบสินค้า/งานจ้าง]]></text>
			</staticText>
			<textField>
				<reportElement x="0" y="66" width="138" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["เรียน         "   +$F{supplier}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="1" y="91" width="217" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["อ้างถึง        ใบสั่งซื้อ/จ้าง หรือสัญญา เลขที่ "+$F{po_no} + "  ลงวันที่"]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="218" y="91" width="100" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{contract_start_date}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="false">
				<reportElement x="217" y="20" width="79" height="20"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="55">
			<textField>
				<reportElement x="41" y="0" width="376" height="15"/>
				<textElement lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["ตามใบสั่งซื้อ/จ้างหรือสัญญาที่อ้างถึง " + $F{operating_unit} + "  ได้ตกลงซื้อ/จ้าง กับ "+$F{supplier} +" เป็นจำนวนเงิน"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="77" y="15" width="379" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["("+$F{amount_total_text_th}+")"+" โดยมีกำหนดส่งมอบสินค้า/งานจ้าง ภายใน "+ $F{in_time}+" วัน"]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="153" y="30" width="136" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{date_order}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="196" y="30" width="19" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[นั้น]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="30" width="199" height="15"/>
				<textElement lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[ซึ่งครบกำหนดการส่งมอบสินค้า/งานจ้างเมื่อวันที่]]></text>
			</staticText>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="0" y="15" width="78" height="17"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{amount}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="55" y="15" width="24" height="18"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[บาท]]></text>
			</staticText>
		</band>
		<band height="16">
			<textField>
				<reportElement x="41" y="0" width="431" height="16"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["บัดนี้ " +$F{supplier}+"  ยังไม่ได้ทำการส่งมอบสินค้า/งานจ้างดังกล่าวให้กับสำนักงานฯ/ศูนย์ฯ  ดังนั้น สำนักงานฯ/ศูนย์ฯ"]]></textFieldExpression>
			</textField>
		</band>
		<band height="68">
			<textField>
				<reportElement x="299" y="16" width="157" height="15"/>
				<textElement lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{amount_fine_per_day_text_th} == null ?
"( " + " )" :
"( " + $F{amount_fine_per_day_text_th} + " )"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="42" y="53" width="264" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[จึงเรียนมาเพื่อโปรดทราบและดำเนินการส่งมอบสินค้า/งานจ้าง ดังกล่าวโดยเร่งด่วน]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="0" width="527" height="16"/>
				<textElement lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[ขอสงวนสิทธิ์ค่าปรับ ในกรณีส่งมอบสินค้า/งานจ้างล่าช้าตามที่ได้ระบุไว้ ในใบสั่งซื้อ/จ้าง หรือสัญญา โดยคิดค่าปรับเป็นรายวัน]]></text>
			</staticText>
			<textField>
				<reportElement x="0" y="16" width="287" height="15"/>
				<textElement lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["ในอัตราร้อยละ "+$F{fine_rate} +" ของราคาสินค้างานจ้างล่าช้า คิดเป็นค่าปรับวันละ"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement x="218" y="16" width="70" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{fine_per_day}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="101" y="31" width="153" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[จนถึงวันที่ส่งมอบสินค้า/งานจ้างถูกต้องครบถ้วน]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="31" width="65" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[โดยนับตั้งแต่วันที่ ]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="57" y="31" width="100" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{date_order} +1]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="269" y="16" width="20" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[บาท]]></text>
			</staticText>
		</band>
	</detail>
	<columnFooter>
		<band height="118" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="106" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="49" splitType="Stretch"/>
	</summary>
</jasperReport>
