<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report3" language="groovy" pageWidth="595" pageHeight="842" columnWidth="431" leftMargin="79" rightMargin="85" topMargin="70" bottomMargin="107">
	<property name="ireport.zoom" value="1.3310000000000008"/>
	<property name="ireport.x" value="80"/>
	<property name="ireport.y" value="239"/>
	<parameter name="IDS" class="java.lang.Object"/>
	<parameter name="PIDS" class="java.util.List" isForPrompting="false">
		<defaultValueExpression><![CDATA[$P{IDS}.toList()]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select
rp.name supplier,
rp_ou.name operating_unit,
po.name PO_NO,
po.date_contract_start contract_start_date,
po.amount_total_text_th,
po.amount_total amount,
pwa.date_receive date_receive,
po.fine_rate fine_rate,
current_date now_date,
po.doc_approve_uid,
hp.name hr_position,
ro.description,
rpa.name name_approve,
convert_from(rp_ou.image, 'UTF8') image ,
po.date_order date_order,
date_part('day',(pwa.date_receive - po.date_order))::integer over_date,
pwa.amount_total_fine_text_th,
pwa.manual_fine,
pwa.amount_fine_per_day_text_th,
pwa.overdue_day,
pwa.fine_per_day

from purchase_order po
left join res_partner rp on po.partner_id = rp.id
left join operating_unit ou on po.operating_unit_id = ou.id
left join res_partner rp_ou on ou.partner_id = rp_ou.id
left join res_country rc on rp_ou.country_id = rc.id
left join res_country_district rcd on rp_ou.district_id = rcd.id
left join purchase_work_acceptance pwa on po.id = pwa.order_id
LEFT JOIN res_users ru ON ru.id = po.doc_approve_uid
LEFT JOIN res_partner rpa ON rpa.id = ru.partner_id
LEFT JOIN hr_employee he ON he.employee_code = ru.login
LEFT JOIN hr_position hp ON hp.id = he.position_id
LEFT JOIN res_org ro ON ro.id = he.org_id

where $X{IN,pwa.id,PIDS} and po.name not like '-']]>
	</queryString>
	<field name="supplier" class="java.lang.String">
		<fieldDescription><![CDATA[Supplier]]></fieldDescription>
	</field>
	<field name="operating_unit" class="java.lang.String"/>
	<field name="po_no" class="java.lang.String"/>
	<field name="contract_start_date" class="java.sql.Date"/>
	<field name="amount_total_text_th" class="java.lang.String">
		<fieldDescription><![CDATA[Amount Total (TH)]]></fieldDescription>
	</field>
	<field name="amount" class="java.math.BigDecimal">
		<fieldDescription><![CDATA[Amount]]></fieldDescription>
	</field>
	<field name="date_receive" class="java.sql.Date">
		<fieldDescription><![CDATA[Receive Date]]></fieldDescription>
	</field>
	<field name="fine_rate" class="java.lang.Double">
		<fieldDescription><![CDATA[Fine Rate]]></fieldDescription>
	</field>
	<field name="now_date" class="java.sql.Date"/>
	<field name="doc_approve_uid" class="java.lang.Integer">
		<fieldDescription><![CDATA[Approved by]]></fieldDescription>
	</field>
	<field name="hr_position" class="java.lang.String"/>
	<field name="description" class="java.lang.String"/>
	<field name="name_approve" class="java.lang.String"/>
	<field name="image" class="java.lang.String">
		<fieldDescription><![CDATA[Photo]]></fieldDescription>
	</field>
	<field name="date_order" class="java.sql.Timestamp">
		<fieldDescription><![CDATA[Order Date]]></fieldDescription>
	</field>
	<field name="over_date" class="java.lang.Integer"/>
	<field name="amount_total_fine_text_th" class="java.lang.String">
		<fieldDescription><![CDATA[Total Fine TH Text]]></fieldDescription>
	</field>
	<field name="manual_fine" class="java.lang.Double">
		<fieldDescription><![CDATA[Manual Fine]]></fieldDescription>
	</field>
	<field name="amount_fine_per_day_text_th" class="java.lang.String">
		<fieldDescription><![CDATA[Fine per Day TH Text]]></fieldDescription>
	</field>
	<field name="overdue_day" class="java.lang.Integer">
		<fieldDescription><![CDATA[Overdue Days]]></fieldDescription>
	</field>
	<field name="fine_per_day" class="java.lang.Double">
		<fieldDescription><![CDATA[Fine per Day]]></fieldDescription>
	</field>
	<background>
		<band height="665" splitType="Stretch">
			<staticText>
				<reportElement x="216" y="468" width="68" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="11" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[ขอแสดงความนับถือ]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="199" y="535" width="100" height="14"/>
				<textElement textAlignment="Center" lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="11" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{hr_position}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="199" y="521" width="100" height="14"/>
				<textElement textAlignment="Center" lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="11" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{name_approve}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="199" y="549" width="100" height="14"/>
				<textElement textAlignment="Center" lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="11" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{description}]]></textFieldExpression>
			</textField>
		</band>
	</background>
	<pageHeader>
		<band height="81" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="119" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="26" height="20"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[ที่ วท]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="40" width="248" height="16"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[เรื่อง          แจ้งค่าปรับเนื่องจากส่งสินค้า/งานจ้าง เกินกำหนด]]></text>
			</staticText>
			<textField>
				<reportElement x="0" y="66" width="129" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["เรียน         "   +$F{supplier}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="1" y="90" width="271" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["อ้างถึง        ใบสั่งซื้อ/จ้าง หรือสัญญา เลขที่ "+$F{po_no}+" ลงวันที่ "]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="215" y="90" width="100" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{contract_start_date}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="215" y="20" width="79" height="20"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</columnHeader>
	<detail>
		<band height="54">
			<staticText>
				<reportElement x="46" y="31" width="80" height="16"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[ความละเอียดแจ้งแล้วนั้น]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="-1" y="31" width="60" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{date_order}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="66" y="15" width="390" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{amount_total_text_th} == null ?
"("+")"+ "โดยกำหนดส่งมอบสินค้า/งานจ้าง ภายในวันที่" :
"("+$F{amount_total_text_th}+")"+ "โดยกำหนดส่งมอบสินค้า/งานจ้าง ภายในวันที่"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="41" y="0" width="374" height="15"/>
				<textElement lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["ตามใบสั่งซื้อ/จ้างหรือสัญญาที่อ้างถึง " + $F{operating_unit} + " ได้ตกลงซื้อ/จ้าง กับ "+$F{supplier} +"  เป็นจำนวนเงิน "]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="48" y="15" width="21" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[บาท]]></text>
			</staticText>
			<textField pattern="#,##0.00" isBlankWhenNull="false">
				<reportElement x="-1" y="15" width="47" height="14"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{amount}]]></textFieldExpression>
			</textField>
		</band>
		<band height="77">
			<textField>
				<reportElement x="41" y="0" width="361" height="16"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{supplier}+ "  ได้ส่งมอบสินค้า/งานจ้างดังกล่าวให้กับสำนักงานฯ/ศูนย์ฯ เป็นที่เรียบร้อยแล้ว เมื่อวันที่"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="1" y="16" width="436" height="16"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[ซึ่งเกินกำหนดการส่งมอบ ดังนั้น สำนักงานฯ/ศูนย์ฯ จึงขอสงวนสิทธิ์ปรับ ในกรณีส่งมอบสินค้า/งานจ้างเกินกำหนด]]></text>
			</staticText>
			<textField>
				<reportElement x="1" y="47" width="105" height="15"/>
				<textElement lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{amount_fine_per_day_text_th} == null ?  '' : "( " +  $F{amount_fine_per_day_text_th}  + " )"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="342" y="32" width="70" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{fine_per_day}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="361" y="0" width="95" height="16"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[$F{date_receive}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="2" y="62" width="435" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[โดยสำนักงานฯ/ศูนย์ฯ จะหักเงินค่าปรับจากเงินที่ต้องชำระค่าสินค้า/งานจ้าง และออกใบเสร็จรับเงินให้ เพื่อเป็นหลักฐานในวันที่รับเช็ค]]></text>
			</staticText>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="239" y="47" width="70" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.Number"><![CDATA[$F{manual_fine}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="false">
				<reportElement x="318" y="47" width="181" height="15"/>
				<textElement lineSpacing="Single" markup="none">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{amount_total_fine_text_th} == null ?  '' : "( " +  $F{amount_total_fine_text_th}  + " )"]]></textFieldExpression>
			</textField>
			<textField pattern="">
				<reportElement x="1" y="32" width="477" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["โดยคิดค่าปรับเป็นรายวัน ในอัตราร้อยละ "+$F{fine_rate}+" ของราคาสินค้า/งานจ้าง ที่ยังไม่ได้ส่งมอบ คิดเป็นค่าปรับวันละ"]]></textFieldExpression>
			</textField>
			<textField pattern="">
				<reportElement x="97" y="47" width="210" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{overdue_day} == null ? "เป็นระยะเวลา "+"0" + " วัน  คิดเป็นค่าปรับทั้งสิ้น" : "เป็นระยะเวลา "+$F{overdue_day} + " วัน  คิดเป็นค่าปรับทั้งสิ้น"]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="287" y="47" width="24" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[บาท]]></text>
			</staticText>
			<staticText>
				<reportElement x="389" y="32" width="24" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[บาท]]></text>
			</staticText>
		</band>
		<band height="62">
			<staticText>
				<reportElement x="1" y="0" width="488" height="15"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[และผู้ขาย/ผู้รับรับจ้างจะต้องออกใบเสร็จรับเงินให้กับสำนักงานฯ/ศูนย์ฯ ตามจำนวนเงินค่าสินค้า/งานจ้างก่อนหักค่าปรับดังกล่าวด้วย]]></text>
			</staticText>
			<staticText>
				<reportElement x="41" y="27" width="169" height="20"/>
				<textElement lineSpacing="Single">
					<font fontName="TH SarabunPSK" size="12" pdfFontName="THSarabun.ttf" pdfEncoding="Identity-H"/>
				</textElement>
				<text><![CDATA[จึงเรียนมาเพื่อโปรดทราบ]]></text>
			</staticText>
		</band>
	</detail>
	<columnFooter>
		<band height="118" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="54" splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band height="42" splitType="Stretch"/>
	</summary>
</jasperReport>
