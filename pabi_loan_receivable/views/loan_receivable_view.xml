<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
	    
        <menuitem id="menu_loan_receivable" name="Loan Receivables" parent="account.menu_finance" sequence="3"
            groups="account.group_account_user,account.group_account_manager"/>
    
    	# Bank Loan MOU
        <record id="view_loan_bank_mou_filter" model="ir.ui.view">
            <field name="name">view.loan.bank.mou.filter</field>
            <field name="model">loan.bank.mou</field>
            <field name="arch" type="xml">
                <search string="Search Bank Loan MOU">
                    <field name="name"/>
                    <group expand="0" string="Group By...">
                        <filter string="Bank" domain="[]" context="{'group_by':'bank_id'}"/>
                    </group>
                </search>
            </field>
        </record>
    
       	<record model="ir.ui.view" id="view_loan_bank_mou_tree">
            <field name="name">view.loan.bank.mou.tree</field>
            <field name="model">loan.bank.mou</field>
            <field name="arch" type="xml">
                <tree string="Bank Loan MOU">
                    <field name="name"/>
                    <field name="bank_id"/>
                    <field name="max_installment"/>
                    <field name="loan_ratio"/>
                </tree>
            </field>
        </record>

        <record model="ir.ui.view" id="view_loan_bank_mou_form">
            <field name="name">view.loan.bank.mou.form</field>
            <field name="model">loan.bank.mou</field>
            <field name="arch" type="xml">
                <form string="Bank Loan MOU" >
                    <group>
                        <group>
                        	<field name="name"/>
                            <field name="bank_id" />
                        </group>
                        <group>
                            <field name="product_id" />
                            <field name="max_installment" />
                            <field name="loan_ratio" />
                        </group>
                    </group>
                </form>
            </field>
        </record>
        
    
		<record id="action_loan_bank_mou" model="ir.actions.act_window">
            <field name="name">Bank Loan MOU</field>
            <field name="res_model">loan.bank.mou</field>
            <field name="view_type">form</field>
            <field name="view_id" eval="False"/>
            <field name="target">current</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to register a new Bank Loan MOU.
              </p>
            </field>
        </record>
        <record id="action_loan_bank_mou_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_loan_bank_mou_tree"/>
            <field name="act_window_id" ref="action_loan_bank_mou"/>
        </record>
        <record id="action_loan_bank_form" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_loan_bank_mou_form"/>
            <field name="act_window_id" ref="action_loan_bank_mou"/>
        </record>

	    <menuitem action="action_loan_bank_mou" sequence="1"
	    	id="menu_action_loan_bank_mou"  parent="menu_loan_receivable"/>
           

   		# Customer Loan Agreement
        <record id="view_loan_customer_agreement_filter" model="ir.ui.view">
            <field name="name">view.loan.bank.mou.filter</field>
            <field name="model">loan.bank.mou</field>
            <field name="arch" type="xml">
                <search string="Search Bank Loan MOU">
                    <field name="name"/>
                    <group expand="0" string="Group By...">
                        <filter string="Bank" domain="[]" context="{'group_by':'bank_id'}"/>
                    </group>
                </search>
            </field>
        </record>
    
       	<record model="ir.ui.view" id="view_loan_customer_agreement_tree">
            <field name="name">view.loan.customer.agreement.tree</field>
            <field name="model">loan.customer.agreement</field>
            <field name="arch" type="xml">
                <tree string="Customer Loan Agreement">
                    <field name="name"/>
                    <field name="mou_id"/>
                    <field name="bank_id"/>
                    <field name="partner_id"/>
                    <field name="amount_loan_total"/>
                    <field name="amount_receivable"/>
                </tree>
            </field>
        </record>
   		
        <record model="ir.ui.view" id="view_loan_customer_agreement_form">
            <field name="name">view.loan.customer.agreement.form</field>
            <field name="model">loan.customer.agreement</field>
            <field name="arch" type="xml">
                <form string="Customer Loan Agreement" >
                <header>
                    <button name="action_sign" string="Sign Document" states="draft" type="object" class="oe_highlight"/>
	                <button name="%(action_create_bank_invoice)d"
	                         string="Create Bank Invoice"
	                         type="action"
	                         groups="account.group_account_invoice"
	                         states="sign"
	                         class="oe_highlight"
	                />              
                    <button name="action_installment" string="Create Installment" type="object" states="bank_paid"/>
                    <button name="action_cancel" string="Cancel" type="object" states="sign"/>
                    <button name="action_cancel_draft" type="object" states="cancel" string="Set to Draft"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,sign,bank_invoice,bank_paid,open,done" />
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <label string="Loan Agreement" />
                            <field name="name" class="oe_inline" />
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="partner_id" />
                            <field name="mou_id" />
                            <field name="bank_id" />
                            <field name="monthly_due_type" />
                            <field name="date_specified" attrs="{'invisible': [('monthly_due_type', '!=', 'specific')]}"/>
                        </group>
                        <group>
                            <field name="amount_loan_total"/>
                            <field name="amount_receivable"/>
                            <field name="installment"/>
                            <label for="date_begin" string="Duration"/>
                            <div>
                                <field name="date_begin" class="oe_inline" nolabel="1"/> -
                                <field name="date_end" nolabel="1" class="oe_inline"/>
                            </div>
                            <field name="supplier_invoice_id" context="{'default_type': 'in_invoice'}"/>
                        </group>
                    </group>
                    <notebook>
	                    <page string="Installment Plan" >
		                    <group>
			                    <group>
			                    	<field name="sale_id" />
			                    </group>
			                    <group>
			                    </group>
		                    </group>
		                   	<field name="invoice_plan_ids" nolabel="1"/>
	                   	</page>
	           		</notebook>
               	</sheet>
                </form>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </field>
        </record>
    
		<record id="action_loan_customer_agreement" model="ir.actions.act_window">
            <field name="name">Loan Agreement</field>
            <field name="res_model">loan.customer.agreement</field>
            <field name="view_type">form</field>
            <field name="view_id" eval="False"/>
            <field name="target">current</field>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to register a new Customer Loan Agreement.
              </p>
            </field>
        </record>
        <record id="action_loan_customer_agreement_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_loan_customer_agreement_tree"/>
            <field name="act_window_id" ref="action_loan_customer_agreement"/>
        </record>
        <record id="action_loan_bank_form" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_loan_customer_agreement_form"/>
            <field name="act_window_id" ref="action_loan_customer_agreement"/>
        </record>
        
	    <menuitem action="action_loan_customer_agreement" sequence="1"
	    	id="menu_action_loan_customer_agreement"  parent="menu_loan_receivable"/>
    </data>
</openerp>