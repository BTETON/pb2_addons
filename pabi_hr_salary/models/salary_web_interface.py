# -*- coding: utf-8 -*-
import xmlrpclib
import requests
import ast
from openerp import models, api, fields, _
from openerp.exceptions import ValidationError


class HRSalaryExpense(models.Model):
    _inherit = 'hr.salary.expense'

    @api.multi
    def send_signal_to_pabiweb(self, signal, salary_doc=False):
        """ Signal: '1' = Submit, '2' = Resubmit, '3' = Cancel
            For 1, 2, require salary_doc """
        self.ensure_one()
        alfresco = \
            self.env['pabi.web.config.settings']._get_alfresco_connect('hr')
        if alfresco is False:
            return False
        arg = {}
        salary = self
        user = self.env.user
        section = self.env.user.partner_id.employee_id.section_id
        if signal in ('1', '2'):  # Start or Resubmit
            if not salary_doc:
                raise ValidationError(_('Salary document not found'))
            other_docs = self.env['ir.attachment'].search([
                ('id', '!=', salary_doc.id),
                ('res_id', '=', self.id),
                ('res_model', '=', 'hr.salary.expense'),
            ])
            attachments = [{'name': doc.name, 'content': doc.datas}
                           for doc in other_docs]
            arg = {
                'action': signal,
                'salaryNo': salary.number,
                'sectionId': str(section.id),
                'objective': salary.name,
                'total': str(salary.amount_total or 0.0),
                'reqBy': user.login,
                'doc': {'name': salary_doc.name,
                        'content': salary_doc.datas},
                'attachments': attachments
            }
        elif signal == '3':  # Cancel
            arg = {
                'action': signal,
                'salaryNo': salary.number,
                'comment': u'',  # Not implemented yet.
                'reqBy': user.login,
            }
        else:
            raise ValidationError(_('Wrong PABIWeb Signal!'))
        result = alfresco.sal.action(arg)
        if not result['success']:
            raise ValidationError(
                _("Can't send data to PabiWeb : %s" % (result['message'],))
            )
        return result

    @api.model
    def test_done_salary(self):
        af_info = {
            'name': 'SLR/003',
            'approve_uid': '000377',
            'action': 'C1',
            'file_name': 'TE00017.pdf',
            'file_url': 'SLR_003.pdf',
            'comment': 'reject reason',
        }
        return self.done_salary(af_info)

    @api.model
    def done_salary(self, af_info):
        """ af_info = {
            'name': 'SAL0001',
            'approve_uid': '000377',
            'action' : 'C1' or 'W2'
            'file_name': 'TE00017.pdf',
            'file_url': 'aaaaas.pdf',
            'comment': 'reject reason',
        }"""
        user = self.env['res.users']
        res = {}
        salary = self.search([('number', '=', af_info['name'])])
        uid = user.search([('login', '=', af_info['approve_uid'])])
        if len(salary) != 1:
            res.update({
                'is_success': False,
                'result': False,
                'messages': _('Cannot verify salary request!'),
            })
            return res
        try:
            if af_info['action'] == 'C1':  # approve
                # Add returned attachment
                file_prefix = self.env.user.company_id.pabiweb_file_prefix
                self.env['ir.attachment'].create({
                    'res_id': salary.id,
                    'res_model': 'hr.salary.expense',
                    'name': af_info['file_name'],
                    'url': file_prefix + af_info['file_url'],
                    'type': 'url',
                })
                # Change states
                salary.write({
                    'approve_user_id': uid.id,
                    'date_approve': fields.Date.context_today(self),
                    'state': 'approve',
                })
            else:  # reject (W1)
                salary.write({
                    'note': af_info['comment'],
                    'state': 'reject'
                })
            res.update({
                'is_success': True,
                'result': True,
            })
        except Exception, e:
            res.update({
                'is_success': False,
                'result': False,
                'messages': _(str(e)),
            })
        return res

    _ODOO_VS_EHR = {
        'name': 'H',
        'date': 'D',
        'currency_id': 'F',
        'line_ids/activity_group_id': False,
        'line_ids/activity_id': False,
        'line_ids/name': 'X',
        'line_ids/section_id': False,
        'line_ids/amount': 'Q',
    }

    @api.multi
    def retrieve_ehr_data(self):
        # TODO:
        self.ensure_one()
        """ Call eHR webservice to get data """
        url = 'http://ehrdev.biotec.or.th:8082/hr/rest/MyHRService/login'
        data = {'username': '999999', 'password': 'csctest'}
        # Login
        response = requests.post(url, data=data)
        res = ast.literal_eval(response.text)
        token = res.get('Bearer', False)
        # Get data
        url = 'http://ehrdev.biotec.or.th:8082/hr/rest/MyHRService/ehr'
        headers = {'Bearer': token}
        response = requests.get(url, headers=headers)
        res = ast.literal_eval(response.text)

        # Load Data
        # Convert from list of data dict line to head and data
        fields, data = self._prepare_data_to_load(res)

        # Load data
        return True

    TEST_DATA = [
        {
            "A": "1",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "11000851",
            "L": "",
            "M": "1000",
            "N": "105051",
            "O": "",
            "P": "",
            "Q": "170500",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินกู้ธนาคารกรุงเทพ ก.พ. 58",
            "Y": "",
            "Z": "105051",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "2",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "11006584",
            "L": "",
            "M": "1000",
            "N": "105051",
            "O": "",
            "P": "",
            "Q": "79300",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินกู้ธนาคารออมสิน ก.พ. 58",
            "Y": "",
            "Z": "105051",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "3",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "50",
            "K": "12909091",
            "L": "",
            "M": "1000",
            "N": "105051",
            "O": "",
            "P": "",
            "Q": "28712",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินกู้น้ำท่วม ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "4",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "50",
            "K": "21050102",
            "L": "",
            "M": "1000",
            "N": "101999",
            "O": "",
            "P": "",
            "Q": "6662765.2",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินสะสมกองทุนสำรองเลี้ยงชีพ ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "5",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "50",
            "K": "21050103",
            "L": "",
            "M": "1000",
            "N": "101999",
            "O": "",
            "P": "",
            "Q": "6008561",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ภาษีหัก ณ ที่จ่าย ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "6",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "31",
            "K": "51000002",
            "L": "",
            "M": "1000",
            "N": "",
            "O": "",
            "P": "",
            "Q": "70512748.96",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ธนาคารกรุงเทพ ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": "C"
        },
        {
            "A": "7",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "31",
            "K": "51000003",
            "L": "",
            "M": "1000",
            "N": "",
            "O": "",
            "P": "",
            "Q": "26754804.69",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ธนาคารกรุงไทย ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": "C"
        },
        {
            "A": "8",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "31",
            "K": "51000004",
            "L": "",
            "M": "1000",
            "N": "",
            "O": "",
            "P": "",
            "Q": "6511400",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินกู้ ธอส. ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": "C"
        },
        {
            "A": "9",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "31",
            "K": "51000005",
            "L": "",
            "M": "1000",
            "N": "",
            "O": "",
            "P": "",
            "Q": "8561310.28",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินหักสหกรณ์ สวทช. ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": "C"
        },
        {
            "A": "10",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "1",
            "K": "51000007",
            "L": "",
            "M": "1000",
            "N": "101999",
            "O": "",
            "P": "",
            "Q": "711305.26",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือนพนักงานโครงการพิเศษที่ใช้ทุนประเดิม ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "11",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "31",
            "K": "51000626",
            "L": "",
            "M": "1000",
            "N": "",
            "O": "",
            "P": "",
            "Q": "2744227.75",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "กองทุนสำรองเลี้ยงชีพ เค มาสเตอร์ พูล ฟันด์-นโยบายหุ้นไม่เกิน 25%ซึ่งจดทะเบียนแล้ว ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": "C"
        },
        {
            "A": "12",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "31",
            "K": "51000783",
            "L": "",
            "M": "1000",
            "N": "101999",
            "O": "",
            "P": "",
            "Q": "4942900",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินกู้ธนาคารกรุงไทย ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "13",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "31",
            "K": "51000902",
            "L": "",
            "M": "1000",
            "N": "",
            "O": "",
            "P": "",
            "Q": "3780820.11",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "กองทุนสำรองเลี้ยงชีพ เค มาสเตอร์ พูล ฟันด์-นโยบายตราสารหนี้ ซึ่งจดทะเบียนแล้ว ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": "C"
        },
        {
            "A": "14",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "31",
            "K": "51001456",
            "L": "",
            "M": "1000",
            "N": "",
            "O": "",
            "P": "",
            "Q": "1746018.6",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "กองทุนสำรองเลี้ยงชีพ เค มาสเตอร์ พูล ฟันด์-นโยบายตราสารทุน ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": "C"
        },
        {
            "A": "15",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010101",
            "L": "",
            "M": "5000",
            "N": "505010",
            "O": "",
            "P": "",
            "Q": "11911228.71",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงาน สวทช. ก.พ. 58",
            "Y": "",
            "Z": "505010",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "16",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010101",
            "L": "",
            "M": "4000",
            "N": "405018",
            "O": "",
            "P": "",
            "Q": "25427182.5",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงาน สวทช. ก.พ. 58",
            "Y": "",
            "Z": "405018",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "17",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010101",
            "L": "",
            "M": "3000",
            "N": "305018",
            "O": "",
            "P": "",
            "Q": "20530681.77",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงาน สวทช. ก.พ. 58",
            "Y": "",
            "Z": "305018",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "18",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010101",
            "L": "",
            "M": "2000",
            "N": "205021",
            "O": "",
            "P": "",
            "Q": "24031411.86",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงาน สวทช. ก.พ. 58",
            "Y": "",
            "Z": "205021",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "19",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010101",
            "L": "",
            "M": "6000",
            "N": "605017",
            "O": "",
            "P": "",
            "Q": "7740911",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงาน สวทช. ก.พ. 58",
            "Y": "",
            "Z": "605017",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "20",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010101",
            "L": "",
            "M": "1000",
            "N": "105050",
            "O": "",
            "P": "",
            "Q": "20625246.78",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงาน สวทช. ก.พ. 58",
            "Y": "",
            "Z": "105050",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "21",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010102",
            "L": "",
            "M": "2000",
            "N": "205021",
            "O": "",
            "P": "",
            "Q": "3406924.52",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงานโครงการ สวทช. ก.พ. 58",
            "Y": "",
            "Z": "205021",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "22",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010102",
            "L": "",
            "M": "1000",
            "N": "105050",
            "O": "",
            "P": "",
            "Q": "137660",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงานโครงการ สวทช. ก.พ. 58",
            "Y": "",
            "Z": "105050",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "23",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010102",
            "L": "",
            "M": "3000",
            "N": "305018",
            "O": "",
            "P": "",
            "Q": "3043392.14",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงานโครงการ สวทช. ก.พ. 58",
            "Y": "",
            "Z": "305018",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "24",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010102",
            "L": "",
            "M": "6000",
            "N": "605017",
            "O": "",
            "P": "",
            "Q": "1171755",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงานโครงการ สวทช. ก.พ. 58",
            "Y": "",
            "Z": "605017",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "25",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010102",
            "L": "",
            "M": "5000",
            "N": "505010",
            "O": "",
            "P": "",
            "Q": "75190",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงานโครงการ สวทช. ก.พ. 58",
            "Y": "",
            "Z": "505010",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "26",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010102",
            "L": "",
            "M": "4000",
            "N": "405018",
            "O": "",
            "P": "",
            "Q": "5018248",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเดือน-พนักงานโครงการ สวทช. ก.พ. 58",
            "Y": "",
            "Z": "405018",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "27",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010201",
            "L": "",
            "M": "1000",
            "N": "105050",
            "O": "",
            "P": "",
            "Q": "11550",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ค่าล่วงเวลา ค่ากะ ก.พ. 58",
            "Y": "",
            "Z": "105050",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "28",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010201",
            "L": "",
            "M": "4000",
            "N": "405018",
            "O": "",
            "P": "",
            "Q": "20600",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ค่าล่วงเวลา ค่ากะ ก.พ. 58",
            "Y": "",
            "Z": "405018",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "29",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010201",
            "L": "",
            "M": "5000",
            "N": "505010",
            "O": "",
            "P": "",
            "Q": "11650",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ค่าล่วงเวลา ค่ากะ ก.พ. 58",
            "Y": "",
            "Z": "505010",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "30",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010201",
            "L": "",
            "M": "6000",
            "N": "605017",
            "O": "",
            "P": "",
            "Q": "800",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ค่าล่วงเวลา ค่ากะ ก.พ. 58",
            "Y": "",
            "Z": "605017",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "31",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010202",
            "L": "",
            "M": "4000",
            "N": "405018",
            "O": "",
            "P": "",
            "Q": "8200",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ค่าล่วงเวลา ค่ากะ ก.พ. 58",
            "Y": "",
            "Z": "405018",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "32",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010301",
            "L": "",
            "M": "2000",
            "N": "205021",
            "O": "",
            "P": "",
            "Q": "334980",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเพิ่มพิเศษ ศช. ก.พ. 58",
            "Y": "",
            "Z": "205021",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "33",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010301",
            "L": "",
            "M": "6000",
            "N": "605017",
            "O": "",
            "P": "",
            "Q": "76450",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเพิ่มพิเศษ ศน. ก.พ. 58",
            "Y": "",
            "Z": "605017",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "34",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010301",
            "L": "",
            "M": "4000",
            "N": "405018",
            "O": "",
            "P": "",
            "Q": "137640",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเพิ่มพิเศษ ศอ. ก.พ. 58",
            "Y": "",
            "Z": "405018",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "35",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51010301",
            "L": "",
            "M": "1000",
            "N": "105050",
            "O": "",
            "P": "",
            "Q": "714570",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินเพิ่มพิเศษ สก. ก.พ. 58",
            "Y": "",
            "Z": "105050",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "36",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51020102",
            "L": "",
            "M": "1000",
            "N": "105051",
            "O": "",
            "P": "",
            "Q": "8271066.46",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินสมทบกองทุนสำรองเลี้ยงชีพ ก.พ. 58",
            "Y": "",
            "Z": "105051",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "37",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51020103",
            "L": "",
            "M": "1000",
            "N": "105051",
            "O": "",
            "P": "",
            "Q": "8732791.02",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ค่ารักษาพยาบาล ก.พ. 58",
            "Y": "",
            "Z": "105051",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "38",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51020103",
            "L": "",
            "M": "1000",
            "N": "105051",
            "O": "",
            "P": "",
            "Q": "8562",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "สวัสดิการเหมาจ่ายอายุเกิน 65 ก.พ. 58",
            "Y": "",
            "Z": "105051",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "39",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51020104",
            "L": "",
            "M": "1000",
            "N": "105051",
            "O": "",
            "P": "",
            "Q": "144740",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ค่าเล่าเรียนบุตร ก.พ. 58",
            "Y": "",
            "Z": "105051",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "40",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51020109",
            "L": "",
            "M": "1000",
            "N": "105051",
            "O": "",
            "P": "",
            "Q": "292000",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินช่วยเหลือพนักงาน ก.พ. 58",
            "Y": "",
            "Z": "105051",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "41",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "51020109_1",
            "L": "",
            "M": "1000",
            "N": "105051",
            "O": "",
            "P": "",
            "Q": "9499.98",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "ค่าตอบแทนพิเศษ(ชายแดนภาคใต้) ก.พ. 58",
            "Y": "",
            "Z": "105051",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "42",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "52010103",
            "L": "",
            "M": "2000",
            "N": "202002",
            "O": "",
            "P": "",
            "Q": "7000",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินสมนาคุณ ก.พ. 58",
            "Y": "",
            "Z": "202002",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "43",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "52010103",
            "L": "",
            "M": "3000",
            "N": "301040",
            "O": "",
            "P": "",
            "Q": "22680",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินสมนาคุณ ก.พ. 58",
            "Y": "",
            "Z": "301040",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "44",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "40",
            "K": "52010103",
            "L": "",
            "M": "3000",
            "N": "301003",
            "O": "",
            "P": "",
            "Q": "7560",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินสมนาคุณ ก.พ. 58",
            "Y": "",
            "Z": "301003",
            "AA": "",
            "AB": "",
            "AC": ""
        },
        {
            "A": "45",
            "B": "NS01",
            "C": "JT",
            "D": "2015-02-24",
            "E": "2015-02-24",
            "F": "THB",
            "G": "",
            "H": "EHR20150224",
            "I": "Int.เงินเดือนก.พ. 58",
            "J": "31",
            "K": "53001212",
            "L": "",
            "M": "1000",
            "N": "",
            "O": "",
            "P": "",
            "Q": "123990.42",
            "R": "",
            "S": "",
            "T": "",
            "U": "",
            "V": "",
            "W": "",
            "X": "เงินหักสหกรณ์กระทรวงวิทย์ ก.พ. 58",
            "Y": "",
            "Z": "",
            "AA": "",
            "AB": "",
            "AC": "C"
        }
    ]
